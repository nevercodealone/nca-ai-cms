---
import { getEntry, render } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

const { slug } = Astro.params;

if (!slug) {
  return Astro.redirect('/');
}

const article = await getEntry('articles', slug);

if (!article) {
  return Astro.redirect('/');
}

const { Content } = await render(article);
---

<Layout title={article.data.title}>
  <article class="article">
    <header>
      <h1>{article.data.title}</h1>
      <p class="description">{article.data.description}</p>
      <div class="meta">
        <time>{article.data.date.toLocaleDateString('de-DE')}</time>
        <span class="tags">{article.data.tags.join(', ')}</span>
      </div>
    </header>

    {article.data.image && (
      <img src={article.data.image} alt={article.data.imageAlt || article.data.title} class="hero" />
    )}

    <div class="content">
      <Content />
    </div>

    <footer>
      <a href="/">Zurück zur Übersicht</a>
      <a href={article.data.source} target="_blank" rel="noopener">Quelle</a>
    </footer>
  </article>
</Layout>

<style>
  .article {
    max-width: 800px;
    margin: 0 auto;
  }

  header {
    margin-bottom: 2rem;
  }

  h1 {
    font-size: 2rem;
    margin-bottom: 1rem;
    line-height: 1.3;
  }

  .description {
    font-size: 1.1rem;
    color: #94a3b8;
    margin-bottom: 1rem;
  }

  .meta {
    display: flex;
    gap: 1rem;
    font-size: 0.875rem;
    color: #64748b;
  }

  .hero {
    width: 100%;
    max-height: 400px;
    object-fit: cover;
    border-radius: 8px;
    margin-bottom: 2rem;
  }

  .content {
    line-height: 1.8;
    font-size: 1.05rem;
  }

  .content :global(h2) {
    font-size: 1.5rem;
    margin-top: 2rem;
    margin-bottom: 1rem;
  }

  .content :global(h3) {
    font-size: 1.25rem;
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
  }

  .content :global(p) {
    margin-bottom: 1rem;
  }

  .content :global(ul), .content :global(ol) {
    margin-bottom: 1rem;
    padding-left: 1.5rem;
  }

  .content :global(li) {
    margin-bottom: 0.5rem;
  }

  footer {
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 1px solid #334155;
    display: flex;
    gap: 2rem;
  }

  footer a {
    color: #3b82f6;
    text-decoration: none;
  }

  footer a:hover {
    text-decoration: underline;
  }
</style>
